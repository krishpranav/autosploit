#!/usr/bin/env ruby

require 'rex/proto/http'

class MetasploitModule < Msf::Auxiliary

    include Msf::Exploit::Remote::HttpClient
    include Msf::Auxiliary::Scanner
  
    def initialize
      super(
        'Name'        => 'Intel AMT Digest Authentication Bypass Scanner',
        'Description' => %q{
          This module scans for Intel Active Management Technology endpoints and attempts
          to bypass authentication using a blank HTTP digest (CVE-2017-5689). This service
          can be found on ports 16992, 16993 (tls), 623, and 624(tls).
        },
        'Author'      => 'hdm',
        'License'     => MSF_LICENSE,
        'References'  =>
          [
            [ 'CVE', '2017-5689' ],
            [ 'URL', 'https://www.embedi.com/news/what-you-need-know-about-intel-amt-vulnerability' ],
            [ 'URL', 'https://security-center.intel.com/advisory.aspx?intelid=INTEL-SA-00075&languageid=en-fr' ],
          ],
        'DisclosureDate' => 'May 05 2017'
      )
  
      register_options(
        [
          Opt::RPORT(16992),
        ])
    end